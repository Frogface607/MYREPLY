# Инструкция по миграции на Supabase

## Шаги миграции

### 1. Обновите схему базы данных

Запустите SQL-миграцию в Supabase SQL Editor:

```sql
-- Файл: supabase/migration_add_metadata.sql
-- Добавляет поле metadata для хранения дополнительных данных бизнеса
```

### 2. Что изменилось

- ✅ **Настройки бизнеса** теперь сохраняются в Supabase (таблица `businesses`)
- ✅ **История ответов** синхронизируется через Supabase (таблица `response_history`)
- ✅ Данные доступны на всех устройствах после авторизации
- ✅ Удалена зависимость от localStorage

### 3. Обратная совместимость

Если у пользователя были данные в localStorage:
- Настройки: при первом сохранении в Settings будут перенесены в Supabase
- История: старая история останется только в браузере (можно экспортировать вручную)

### 4. Проверка работы

1. Откройте Settings - настройки должны загрузиться из Supabase
2. Сохраните настройки - они должны сохраниться в БД
3. Создайте ответ в Quick Reply - он должен сохраниться в историю
4. Откройте History - история должна загрузиться из Supabase

### 5. Troubleshooting

Если данные не загружаются:
- Проверьте авторизацию (пользователь должен быть залогинен)
- Проверьте RLS политики в Supabase
- Проверьте, что миграция выполнена успешно (поле `metadata` существует в таблице `businesses`)

